<html class="_theme-default">
<head>
    <meta charset="utf-8">
    <title>6.6. Constructing Function Calls</title>
    
    <link rel="preload" href="assets/index.js" as="script" type="text/javascript" />

    <link rel="stylesheet" type="text/css" href="application.css" />
    <link rel="stylesheet" type="text/css" href="assets/index.css" />
</head>
<body>
    <div class="_app">
        <devdocs-navbar current="constructing-calls" prefix="" listing-src="navbar.json"></devdocs-navbar>
        <div class="_container">
            <main class="_content">
                <div class="_page _gcc"><h1 class="section" id="Constructing-Function-Calls">6.6 Constructing Function Calls</h1>   <p id="index-forwarding-calls">Using the built-in functions described below, you can record the arguments a function received, and call another function with the same arguments, without knowing the number or types of the arguments. </p> <p>You can also record the return value of that function call, and later return that value, without knowing what data type the function tried to return (as long as your caller expects that data type). </p> <p>However, these built-in functions may interact badly with some sophisticated features or other extensions of the language. It is, therefore, not recommended to use them outside very simple functions acting as mere forwarders for their arguments. </p> <dl> <dt>Built-in Function: void * <strong id="index-_005f_005fbuiltin_005fapply_005fargs">__builtin_apply_args</strong> ()</dt> <dd>
<p>This built-in function returns a pointer to data describing how to perform a call with the same arguments as are passed to the current function. </p> <p>The function saves the arg pointer register, structure value address, and all registers that might be used to pass arguments to a function into a block of memory allocated on the stack. Then it returns the address of that block. </p>
</dd>
</dl> <dl> <dt>Built-in Function: void * <strong id="index-_005f_005fbuiltin_005fapply">__builtin_apply</strong> (void (*<var>function</var>)(), void *<var>arguments</var>, size_t <var>size</var>)</dt> <dd>
<p>This built-in function invokes <var>function</var> with a copy of the parameters described by <var>arguments</var> and <var>size</var>. </p> <p>The value of <var>arguments</var> should be the value returned by <code>__builtin_apply_args</code>. The argument <var>size</var> specifies the size of the stack argument data, in bytes. </p> <p>This function returns a pointer to data describing how to return whatever value is returned by <var>function</var>. The data is saved in a block of memory allocated on the stack. </p> <p>It is not always simple to compute the proper value for <var>size</var>. The value is used by <code>__builtin_apply</code> to compute the amount of data that should be pushed on the stack and copied from the incoming argument area. </p>
</dd>
</dl> <dl> <dt>Built-in Function: void <strong id="index-_005f_005fbuiltin_005freturn">__builtin_return</strong> (void *<var>result</var>)</dt> <dd><p>This built-in function returns the value described by <var>result</var> from the containing function. You should specify, for <var>result</var>, a value returned by <code>__builtin_apply</code>. </p></dd>
</dl> <dl> <dt>Built-in Function:  <strong id="index-_005f_005fbuiltin_005fva_005farg_005fpack">__builtin_va_arg_pack</strong> ()</dt> <dd>
<p>This built-in function represents all anonymous arguments of an inline function. It can be used only in inline functions that are always inlined, never compiled as a separate function, such as those using <code>__attribute__ ((__always_inline__))</code> or <code>__attribute__ ((__gnu_inline__))</code> extern inline functions. It must be only passed as last argument to some other function with variable arguments. This is useful for writing small wrapper inlines for variable argument functions, when using preprocessor macros is undesirable. For example: </p>
<div class="smallexample"> <pre class="smallexample" data-language="cpp">extern int myprintf (FILE *f, const char *format, ...);
extern inline __attribute__ ((__gnu_inline__)) int
myprintf (FILE *f, const char *format, ...)
{
  int r = fprintf (f, "myprintf: ");
  if (r &lt; 0)
    return r;
  int s = fprintf (f, format, __builtin_va_arg_pack ());
  if (s &lt; 0)
    return s;
  return r + s;
}</pre>
</div> </dd>
</dl> <dl> <dt>Built-in Function: size_t <strong id="index-_005f_005fbuiltin_005fva_005farg_005fpack_005flen">__builtin_va_arg_pack_len</strong> ()</dt> <dd>
<p>This built-in function returns the number of anonymous arguments of an inline function. It can be used only in inline functions that are always inlined, never compiled as a separate function, such as those using <code>__attribute__ ((__always_inline__))</code> or <code>__attribute__ ((__gnu_inline__))</code> extern inline functions. For example following does link- or run-time checking of open arguments for optimized code: </p>
<div class="smallexample"> <pre class="smallexample" data-language="cpp">#ifdef __OPTIMIZE__
extern inline __attribute__((__gnu_inline__)) int
myopen (const char *path, int oflag, ...)
{
  if (__builtin_va_arg_pack_len () &gt; 1)
    warn_open_too_many_arguments ();

  if (__builtin_constant_p (oflag))
    {
      if ((oflag &amp; O_CREAT) != 0 &amp;&amp; __builtin_va_arg_pack_len () &lt; 1)
        {
          warn_open_missing_mode ();
          return __open_2 (path, oflag);
        }
      return open (path, oflag, __builtin_va_arg_pack ());
    }

  if (__builtin_va_arg_pack_len () &lt; 1)
    return __open_2 (path, oflag);

  return open (path, oflag, __builtin_va_arg_pack ());
}
#endif</pre>
</div> </dd>
</dl>  <p class="header"> <p> Next: <a href="typeof#Typeof" accesskey="n" rel="next">Typeof</a>, Previous: <a href="nonlocal-gotos#Nonlocal-Gotos" accesskey="p" rel="prev">Nonlocal Gotos</a>, Up: <a href="c-extensions#C-Extensions" accesskey="u" rel="up">C Extensions</a> [<a href="index#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="https://gcc.gnu.org/onlinedocs/gcc-9.5.0/gcc/Option-Index.html#Option-Index" title="Index" rel="index">Index</a>]</p> </p><div class="_attribution">
  <p class="_attribution-p">
    &copy; Free Software Foundation<br>Licensed under the GNU Free Documentation License, Version 1.3.<br>
    <a href="https://gcc.gnu.org/onlinedocs/gcc-9.5.0/gcc/Constructing-Calls.html" class="_attribution-link">https://gcc.gnu.org/onlinedocs/gcc-9.5.0/gcc/Constructing-Calls.html</a>
  </p>
</div>
</div>
            </main>
        </div>
    </div>
    <script type="text/javascript" src="assets/index.js"></script>
</body>

</html>