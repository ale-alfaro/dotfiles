<html class="_theme-default">
<head>
    <meta charset="utf-8">
    <title>6.2. Locally Declared Labels</title>
    
    <link rel="preload" href="assets/index.js" as="script" type="text/javascript" />

    <link rel="stylesheet" type="text/css" href="application.css" />
    <link rel="stylesheet" type="text/css" href="assets/index.css" />
</head>
<body>
    <div class="_app">
        <devdocs-navbar current="local-labels" prefix="" listing-src="navbar.json"></devdocs-navbar>
        <div class="_container">
            <main class="_content">
                <div class="_page _gcc"><h1 class="section" id="Locally-Declared-Labels">6.2 Locally Declared Labels</h1>   <p id="index-macros_002c-local-labels">GCC allows you to declare <em>local labels</em> in any nested block scope. A local label is just like an ordinary label, but you can only reference it (with a <code>goto</code> statement, or by taking its address) within the block in which it is declared. </p> <p>A local label declaration looks like this: </p> <div class="smallexample"> <pre class="smallexample" data-language="cpp">__label__ <var>label</var>;</pre>
</div> <p>or </p> <div class="smallexample"> <pre class="smallexample" data-language="cpp">__label__ <var>label1</var>, <var>label2</var>, /* <span class="roman">â€¦</span> */;</pre>
</div> <p>Local label declarations must come at the beginning of the block, before any ordinary declarations or statements. </p> <p>The label declaration defines the label <em>name</em>, but does not define the label itself. You must do this in the usual way, with <code><var>label</var>:</code>, within the statements of the statement expression. </p> <p>The local label feature is useful for complex macros. If a macro contains nested loops, a <code>goto</code> can be useful for breaking out of them. However, an ordinary label whose scope is the whole function cannot be used: if the macro can be expanded several times in one function, the label is multiply defined in that function. A local label avoids this problem. For example: </p> <div class="smallexample"> <pre class="smallexample" data-language="cpp">#define SEARCH(value, array, target)              \
do {                                              \
  __label__ found;                                \
  typeof (target) _SEARCH_target = (target);      \
  typeof (*(array)) *_SEARCH_array = (array);     \
  int i, j;                                       \
  int value;                                      \
  for (i = 0; i &lt; max; i++)                       \
    for (j = 0; j &lt; max; j++)                     \
      if (_SEARCH_array[i][j] == _SEARCH_target)  \
        { (value) = i; goto found; }              \
  (value) = -1;                                   \
 found:;                                          \
} while (0)</pre>
</div> <p>This could also be written using a statement expression: </p> <div class="smallexample"> <pre class="smallexample" data-language="cpp">#define SEARCH(array, target)                     \
({                                                \
  __label__ found;                                \
  typeof (target) _SEARCH_target = (target);      \
  typeof (*(array)) *_SEARCH_array = (array);     \
  int i, j;                                       \
  int value;                                      \
  for (i = 0; i &lt; max; i++)                       \
    for (j = 0; j &lt; max; j++)                     \
      if (_SEARCH_array[i][j] == _SEARCH_target)  \
        { value = i; goto found; }                \
  value = -1;                                     \
 found:                                           \
  value;                                          \
})</pre>
</div> <p>Local label declarations also make the labels they declare visible to nested functions, if there are any. See <a href="nested-functions#Nested-Functions">Nested Functions</a>, for details. </p>  <p class="header"> <p> Next: <a href="labels-as-values#Labels-as-Values" accesskey="n" rel="next">Labels as Values</a>, Previous: <a href="statement-exprs#Statement-Exprs" accesskey="p" rel="prev">Statement Exprs</a>, Up: <a href="c-extensions#C-Extensions" accesskey="u" rel="up">C Extensions</a> [<a href="index#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="https://gcc.gnu.org/onlinedocs/gcc-9.5.0/gcc/Option-Index.html#Option-Index" title="Index" rel="index">Index</a>]</p> </p><div class="_attribution">
  <p class="_attribution-p">
    &copy; Free Software Foundation<br>Licensed under the GNU Free Documentation License, Version 1.3.<br>
    <a href="https://gcc.gnu.org/onlinedocs/gcc-9.5.0/gcc/Local-Labels.html" class="_attribution-link">https://gcc.gnu.org/onlinedocs/gcc-9.5.0/gcc/Local-Labels.html</a>
  </p>
</div>
</div>
            </main>
        </div>
    </div>
    <script type="text/javascript" src="assets/index.js"></script>
</body>

</html>